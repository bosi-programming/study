<script>
import { octokitMixin } from "@/mixins/octokitMixin";
import IssueComments from "./issue/Comments.vue";

export default {
  name: "RepoIssues",
  components: {
    IssueComments,
  },
  props: {
    owner: {
      type: String,
      required: true,
    },
    repo: {
      type: String,
      required: true,
    },
    mixins: [octokitMixin],
    data() {
      return {
        issues: [],
        showIssues: false,
      };
    },
    methods: {
      async getRepoIssues(owner, repo) {
        const octokit = this.createOctokitClient();
        const { data: issues } = await octokit.issues.listForRepo({
          owner,
          repo,
        });
        this.issues = issues;
      },
    },
    watch: {
      owner: {
        handler(val) {
          this.getRepoIssues(val, this.repo);
        },
      },
      repo: {
        handler(val) {
          this.getRepoIssues(this.owner, val);
        },
      },
    },
    created() {
      this.getRepoIssues(this.owner, this.repo);
    },
  },
};
</script>
